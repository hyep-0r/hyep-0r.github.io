<html><head>
<title>Snake</title>
<style>
  body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background-color: #f0f0f0; }
  canvas { border: 1px solid black; }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="400"></canvas>
<div class="footer">Controls: WASD / Arrow keys — Jump: Space — Camera: Drag</div>
<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const gridSize = 20; // Size of each square in the grid
  const tileCount = canvas.width / gridSize; // Number of tiles in a row/column

  let snake = [{ x: 10, y: 10 }]; // Snake's initial position (array of points)
  let food = getRandomFoodPosition();
  let dx = gridSize; // Horizontal velocity
  let dy = 0;        // Vertical velocity
  let changingDirection = false;
  let score = 0;

  // Game loop
  function gameLoop() {
    if (isGameOver()) {
      alert(`Game Over! Your score: ${score}`);
      location.reload()
      return;
    }

    changingDirection = false;
    setTimeout(() => {
      clearCanvas();
      drawFood();
      moveSnake();
      drawSnake();
      gameLoop();
    }, 100); // Adjust game speed here (milliseconds)
  }

  function clearCanvas() {
    ctx.fillStyle = 'white';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  }

  function drawSnakePart(snakePart) {
    ctx.fillStyle = 'lightgreen';
    ctx.strokeStyle = 'darkgreen';
    ctx.fillRect(snakePart.x * gridSize, snakePart.y * gridSize, gridSize, gridSize);
    ctx.strokeRect(snakePart.x * gridSize, snakePart.y * gridSize, gridSize, gridSize);
  }

  function drawSnake() {
    snake.forEach(drawSnakePart);
  }

  function moveSnake() {
    const head = { x: snake[0].x + dx / gridSize, y: snake[0].y + dy / gridSize };
    snake.unshift(head); // Add new head

    const didEatFood = snake[0].x === food.x && snake[0].y === food.y;
    if (didEatFood) {
      score += 10;
      food = getRandomFoodPosition();
    } else {
      snake.pop(); // Remove tail if no food eaten
    }
  }

  function drawFood() {
    ctx.fillStyle = 'red';
    ctx.strokeStyle = 'darkred';
    ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize, gridSize);
    ctx.strokeRect(food.x * gridSize, food.y * gridSize, gridSize, gridSize);
  }

  function getRandomFoodPosition() {
    let newFoodPosition;
    while (true) {
      newFoodPosition = {
        x: Math.floor(Math.random() * tileCount),
        y: Math.floor(Math.random() * tileCount)
      };
      // Ensure food is not on the snake
      let collisionWithSnake = false;
      for (let i = 0; i < snake.length; i++) {
        if (newFoodPosition.x === snake[i].x && newFoodPosition.y === snake[i].y) {
          collisionWithSnake = true;
          break;
        }
      }
      if (!collisionWithSnake) {
        return newFoodPosition;
      }
    }
  }

  function isGameOver() {
    // Check wall collision
    if (
      snake[0].x < 0 ||
      snake[0].x >= tileCount ||
      snake[0].y < 0 ||
      snake[0].y >= tileCount
    ) {
      return true;
    }
    // Check self-collision
    for (let i = 1; i < snake.length; i++) {
      if (snake[i].x === snake[0].x && snake[i].y === snake[0].y) {
        return true;
      }
    }
    return false;
  }

  // Handle keyboard input
  document.addEventListener('keydown', changeDirection);

  function changeDirection(event) {
    const LEFT_KEY = 37;
    const RIGHT_KEY = 39;
    const UP_KEY = 38;
    const DOWN_KEY = 40;

    if (changingDirection) return;
    changingDirection = true;

    const keyPressed = event.keyCode;
    const goingUp = dy === -gridSize;
    const goingDown = dy === gridSize;
    const goingRight = dx === gridSize;
    const goingLeft = dx === -gridSize;

    if (keyPressed === LEFT_KEY && !goingRight) {
      dx = -gridSize;
      dy = 0;
    }
    if (keyPressed === UP_KEY && !goingDown) {
      dx = 0;
      dy = -gridSize;
    }
    if (keyPressed === RIGHT_KEY && !goingLeft) {
      dx = gridSize;
      dy = 0;
    }
    if (keyPressed === DOWN_KEY && !goingUp) {
      dx = 0;
      dy = gridSize;
    }
  }

  // Start the game
  gameLoop();
</script>
<script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;f5707a627d6b490e943a3856b7770957&quot;,&quot;r&quot;:1,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>


</body></html>
